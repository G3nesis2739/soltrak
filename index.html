  <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronos Nexus - Advanced Time Calculator</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.34/moment-timezone-with-data.min.js"></script>
    <style>
        /* Comprehensive CSS Styles */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f1c40f;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 2rem;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.7rem 1.2rem;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.25);
        }

        main {
            flex: 1;
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            width: 100%;
        }

        .time-system-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .time-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .time-card:hover {
            transform: translateY(-5px);
        }

        .time-card h3 {
            margin-bottom: 1rem;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        #map {
            height: 500px;
            width: 100%;
            border-radius: 12px;
            margin: 2rem 0;
            box-shadow: var(--shadow);
        }

        .result-value {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
            margin: 1rem 0;
            padding: 0.8rem;
            background: var(--light);
            border-radius: 6px;
            text-align: center;
        }

        .calculation-details {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        /* Advanced Controls */
        .settings-panel {
            margin: 2rem 0;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            #map {
                height: 300px;
            }

            .time-system-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-clock"></i>
                Chronos Nexus
            </div>
            <div class="nav-links">
                <a href="#" class="active" data-page="calculator"><i class="fas fa-calculator"></i> Time Calculator</a>
                <a href="#" data-page="historical"><i class="fas fa-book"></i> Historical Context</a>
                <a href="#" data-page="methods"><i class="fas fa-compass"></i> Calculation Methods</a>
            </div>
        </nav>
    </header>

    <main>
        <!-- Time Calculator Section -->
        <section id="calculator" class="page active">
            <div class="settings-panel">
                <h2><i class="fas fa-globe"></i> Global Time Calculator</h2>
                <div class="search-container">
                    <div class="search-box">
                        <div class="search-form">
                            <input type="text" id="coordinatesInput" 
                                   placeholder="Enter coordinates or city name"
                                   class="search-input">
                            <button id="calculateButton" class="search-btn">
                                <i class="fas fa-search"></i> Calculate Times
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="map"></div>

                <div class="time-system-grid">
                    <div class="time-card">
                        <h3><i class="fas fa-sun"></i> Solar Time</h3>
                        <div id="solarTime" class="result-value">-</div>
                        <div class="calculation-details">
                            Calculated using sun position with equation of time correction
                        </div>
                    </div>
                    
                    <div class="time-card">
                        <h3><i class="fas fa-building"></i> Political Time</h3>
                        <div id="politicalTime" class="result-value">-</div>
                        <div class="calculation-details">
                            Local time zone: <span id="timeZone">-</span>
                        </div>
                    </div>
                    
                    <div class="time-card">
                        <h3><i class="fas fa-monument"></i> Kemet Time</h3>
                        <div id="kemetTime" class="result-value">-</div>
                        <div class="calculation-details">
                            Hours since sunrise: <span id="hoursSinceSunrise">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other sections remain similar but enhanced -->
    </main>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/suncalc"></script>
    <script>
        // Time Zone API Configuration
        const TIMEZONE_API_KEY = '0QWWBBDL4O5A';
        let currentPosition = { lat: 51.5074, lng: -0.1278 }; // Default to London

        // Map Initialization
        const map = L.map('map').setView([currentPosition.lat, currentPosition.lng], 8);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);
        let marker = L.marker(currentPosition).addTo(map);

        // Time Calculation Functions
        async function calculateAllTimes(lat, lng) {
            try {
                // Get time zone data
                const tzResponse = await fetch(
                    `https://api.timezonedb.com/v2.1/get-time-zone?key=${TIMEZONE_API_KEY}&format=json&by=position&lat=${lat}&lng=${lng}`
                );
                const tzData = await tzResponse.json();

                // Calculate solar times
                const now = new Date();
                const sunTimes = SunCalc.getTimes(now, lat, lng);
                const solarNoon = SunCalc.getPosition(sunTimes.solarNoon, lat, lng);

                // Calculate Kemet time
                const sunrise = sunTimes.sunrise;
                const kemetHours = ((now - sunrise) / (1000 * 60 * 60)).toFixed(1);

                return {
                    solar: formatSolarTime(now, lng, sunTimes),
                    political: moment(now).tz(tzData.zoneName).format('HH:mm'),
                    kemet: kemetHours > 0 ? `${kemetHours} seasonal hours` : 'Before sunrise',
                    zoneName: tzData.zoneName,
                    sunrise: sunrise.toLocaleTimeString()
                };
            } catch (error) {
                console.error('Error calculating times:', error);
                return null;
            }
        }

        function formatSolarTime(date, lng, sunTimes) {
            // Solar time calculation considering equation of time
            const solarNoon = sunTimes.solarNoon;
            const offset = (date - solarNoon) / 60000;
            const adjustedTime = new Date(date.getTime() + offset * 60000);
            return adjustedTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        // Event Handlers and UI Updates
        document.getElementById('calculateButton').addEventListener('click', async () => {
            const input = document.getElementById('coordinatesInput').value;
            const coords = await parseCoordinates(input);
            
            if (coords) {
                currentPosition = coords;
                marker.setLatLng(currentPosition);
                map.setView(currentPosition, 8);
                
                const times = await calculateAllTimes(currentPosition.lat, currentPosition.lng);
                updateDisplay(times);
            }
        });

        async function parseCoordinates(input) {
            // Coordinate parsing logic
            // Can be enhanced with geocoding
            const coordPattern = /^(-?\d+\.?\d*),\s*(-?\d+\.?\d*)$/;
            const match = input.match(coordPattern);
            return match ? { lat: parseFloat(match[1]), lng: parseFloat(match[2]) } : null;
        }

        function updateDisplay(data) {
            document.getElementById('solarTime').textContent = data.solar;
            document.getElementById('politicalTime').textContent = data.political;
            document.getElementById('kemetTime').textContent = data.kemet;
            document.getElementById('timeZone').textContent = data.zoneName;
            document.getElementById('hoursSinceSunrise').textContent = data.sunrise;
        }

        // Initial Calculation
        calculateAllTimes(currentPosition.lat, currentPosition.lng).then(updateDisplay);
    </script>
</body>
</html>
